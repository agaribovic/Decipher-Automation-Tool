<exec>

arr1 = [13.8178736425612]
arr2 = [-2.41082786358483]
arr3 = [31.7804009541152]
#coeffarr1 = [422.108204209175,389.110963042351,306.136946126700,228.943999987030,145.399992310564,59.928574372448,0,-428.634273022137,-372.001302501161,-291.316468155660,-213.802261186862,-127.304693061950,-47.441256162530,0,6.490840144670,47.002917308362,-25.375483812734,-6.861833257262,-7.560204315860,-0.218583468094,0,-23.214717572685,-9.707418509425,-14.909893103831,-12.605356453459,-17.540393567644,0.464153397568,0,10.419600458335,9.965904777642,8.547520225740,0.258009501424,0.843215121133,0.087469739896,0,9.026953642117,7.507649365394,3.344705397465,3.584204244708,12.008755560499,-1.047559640161,0]
#coeffarr2 = [301.403410904426,283.445504631806,227.993156240353,176.008276803318,114.727152172620,50.268746291146,0,-286.582907257865,-248.474651310329,-194.126723167597,-142.250689762766,-79.133101474291,-23.241301024039,0,22.760336673313,64.357600245946,-11.639304057058,-2.012686537988,-4.704289250763,0.397302598357,0,-7.384026891983,-7.667535739203,-11.757753935838,-9.934804093311,-16.295306798791,2.108638658253,0,6.349799374060,9.900941441458,7.944397390986,0.036956925529,1.281678767992,-0.693912077651,0,13.845827315230,3.225062632622,-1.142935299707,0.333964967492,9.693832182767,-1.435360252058,0]
#coeffarr3 = [382.846467129583,352.258173311231,270.208229415388,197.616527448935,120.369388069424,41.158060686981,0,-383.911473349655,-350.103261587859,-271.916053112701,-196.269963610825,-115.469509201164,-42.286267168513,0,-11.076710468436,48.101509233192,-37.472793065666,-5.723603825629,-6.780326503062,-0.308112884797,0,-23.072432443374,-11.995435913120,-14.954366083779,-13.078450094531,-18.321716453643,0.684125491654,0,9.492118147190,11.036639677397,9.115846334677,0.261940953549,1.187357492935,-1.094015749817,0,-23.569605819680,-11.612280695843,-2.214185226634,-0.182542523809,9.380878363785,-1.437545203743,0]
coeffarr1 = [422.108204209175,389.110963042351,306.1369461267,228.94399998703,145.399992310564,59.9285743724479,0,-428.634273022137,-372.001302501161,-291.31646815566,-213.802261186862,-127.30469306195,-47.4412561625298,0,6.49084014466993,47.0029173083623,-25.3754838127335,-6.86183325726157,-7.56020431586032,-0.218583468094297,0,-23.2147175726847,-9.70741850942541,-14.9098931038313,-12.6053564534592,-17.5403935676444,0.464153397568263,0,10.4196004583345,9.96590477764162,8.54752022573958,0.258009501424133,0.843215121132574,0.08746973989598,0,9.02695364211674,7.50764936539375,3.34470539746458,3.58420424470815,12.0087555604989,-1.04755964016147,0]
coeffarr2 = [301.403410904426,283.445504631806,227.993156240353,176.008276803318,114.72715217262,50.2687462911455,0,-286.582907257865,-248.474651310329,-194.126723167597,-142.250689762766,-79.1331014742912,-23.2413010240388,0,22.7603366733134,64.3576002459457,-11.6393040570583,-2.01268653798814,-4.70428925076318,0.397302598356995,0,-7.38402689198326,-7.66753573920291,-11.7577539358384,-9.93480409331113,-16.2953067987905,2.10863865825254,0,6.34979937405974,9.90094144145812,7.94439739098598,0.036956925529157,1.28167876799222,-0.693912077651126,0,13.8458273152301,3.2250626326223,-1.14293529970687,0.333964967491657,9.69383218276732,-1.43536025205836,0]
coeffarr3 = [382.846467129583,352.258173311231,270.208229415388,197.616527448935,120.369388069424,41.1580606869809,0,-383.911473349655,-350.103261587859,-271.916053112701,-196.269963610825,-115.469509201164,-42.2862671685131,0,-11.0767104684364,48.1015092331918,-37.4727930656655,-5.72360382562882,-6.78032650306223,-0.308112884796602,0,-23.0724324433742,-11.9954359131202,-14.954366083779,-13.0784500945312,-18.3217164536425,0.684125491654457,0,9.49211814718976,11.0366396773971,9.11584633467743,0.261940953548815,1.18735749293453,-1.0940157498168,0,-23.5696058196797,-11.6122806958425,-2.21418522663399,-0.182542523809484,9.38087836378496,-1.43754520374333,0]


calarr = []
# codearr = ['r3','r4','r5','r6']
codearr = ['r1','r2','r3','r4','r5','r6']
for x in range(0,len(codearr)):
	for y in S13.cols:
		if S13.attr(codearr[x]).val == y.index:
			num = 1
		else:
			num = 0
		calarr.append(num)

for x in range(0,len(calarr)):
	pnum1 = float(calarr[x])*float(coeffarr1[x])
	pnum2 = float(calarr[x])*float(coeffarr2[x])
	pnum3 = float(calarr[x])*float(coeffarr3[x])
	arr1.append(pnum1)
	arr2.append(pnum2)
	arr3.append(pnum3)

sumarr1 = sum(arr1)
sumarr2 = sum(arr2)
sumarr3 = sum(arr3)

import math
expval1 = math.exp(sumarr1)
expval2 = math.exp(sumarr2)
expval3 = math.exp(sumarr3)

sumstep = float(expval1)+float(expval2)+float(expval3)
segstep = float(1)/(float(1)+float(sumstep))

segval1 = float(expval1)*segstep
segval2 = float(expval2)*segstep
segval3 = float(expval3)*segstep
segval4 = segstep

segarr = [segval1, segval2, segval3, segval4]

maxval = max(segarr)
fval = segarr.index(maxval)

hSeg.val = fval

#Second Segment punching
tarr = [segval1, segval2, segval3, segval4]
tarr2 = [segval1, segval2, segval3, segval4]

tarr.remove(maxval)

seg2 = max(tarr)
fval2 = tarr2.index(seg2)

hSeg2.val = fval2
</exec>

<suspend/>

<radio 
  label="hSeg"
  optional="1"
  where="execute,survey,report">
  <title>Segment</title>
  <row label="r1" value="1">Segment 1</row>
  <row label="r2" value="2">Segment 2</row>
  <row label="r3" value="3">Segment 3</row>
  <row label="r4" value="4">Segment 4</row>
</radio>

<suspend/>

<exec>
if hSeg.r1:	hSegL.val = hSegL.r2.index
elif hSeg.r2:	hSegL.val = hSegL.r4.index
elif hSeg.r3:	hSegL.val = hSegL.r1.index
elif hSeg.r4:	hSegL.val = hSegL.r3.index
</exec>

<radio 
  label="hSegL"
  optional="1"
  where="execute,survey,report">
  <title>Segment</title>
  <row label="r1" value="1">Segment A</row>
  <row label="r2" value="2">Segment B</row>
  <row label="r3" value="3">Segment C</row>
  <row label="r4" value="4">Segment D</row>
</radio>

<suspend/>

<radio 
  label="hSeg2"
  optional="1"
  where="execute,survey,report">
  <title>Hidden variable to punch second segment</title>
  <row label="r1" value="1">Segment 1</row>
  <row label="r2" value="2">Segment 2</row>
  <row label="r3" value="3">Segment 3</row>
  <row label="r4" value="4">Segment 4</row>
</radio>

<suspend/>